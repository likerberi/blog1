<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FastAPI 학습 프로젝트</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <!-- 상단 헤더 -->
    <header class="top-header">
      <h1>🚀 FastAPI 학습 프로젝트</h1>
      <p class="subtitle">왼쪽 버튼을 클릭하면 오른쪽에 결과와 코드 흐름이 나타납니다!</p>
    </header>

    <!-- 좌우 분할 컨테이너 -->
    <div class="split-container">
      <!-- 왼쪽 패널: 컨트롤 -->
      <div class="left-panel">
        <!-- 입력 필드 -->
        <section class="card input-section">
          <h3>📝 입력 데이터</h3>
          <div class="input-grid">
            <label>ID<input type="number" id="item-id" placeholder="1" value="1" /></label>
            <label>제목<input type="text" id="item-title" placeholder="FastAPI 공부" value="FastAPI 공부" /></label>
            <label>설명<input type="text" id="item-description" placeholder="설명" value="라우터 → 서비스 → 저장소" /></label>
            <label class="checkbox-label">
              <input type="checkbox" id="item-done" />
              완료
            </label>
          </div>
        </section>

        <!-- Step 1: 메모리 -->
        <section class="card">
          <h2>메모리 저장소 (Step 1)</h2>
          <p class="hint">Python dict로 저장 - 서버 재시작 시 데이터 초기화</p>
          <div class="button-grid">
            <button data-action="health">1. 상태 확인</button>
            <button data-action="create">2. 생성</button>
            <button data-action="list">3. 목록 조회</button>
            <button data-action="get">4. 단일 조회</button>
            <button data-action="update">5. 수정</button>
            <button data-action="delete">6. 삭제</button>
            <button data-action="reset">7. 초기화</button>
          </div>
        </section>

        <!-- Step 2: DB -->
        <section class="card">
          <h2>DB 저장소 + Depends (Step 2)</h2>
          <p class="hint">SQLite + SQLAlchemy - 데이터 영구 저장</p>
          <div class="button-grid db-buttons">
            <button data-action="health_db">1. 상태 확인</button>
            <button data-action="create_db">2. 생성</button>
            <button data-action="list_db">3. 목록 조회</button>
            <button data-action="get_db">4. 단일 조회</button>
            <button data-action="update_db">5. 수정</button>
            <button data-action="delete_db">6. 삭제</button>
            <button data-action="reset_db">7. 초기화</button>
          </div>
        </section>

        <!-- Step 3: 인증 -->
        <section class="card">
          <h2>JWT 인증 + 미들웨어 (Step 3)</h2>
          <p class="hint">회원가입 → 로그인 → 토큰으로 보호된 API 호출</p>
          <div class="input-grid" style="margin-bottom: 15px;">
            <label>Username<input type="text" id="auth-username" placeholder="testuser" value="testuser" /></label>
            <label>Password<input type="password" id="auth-password" placeholder="password" value="password123" /></label>
          </div>
          <div id="token-status" style="font-size: 0.85rem; color: #666; margin-bottom: 10px;">토큰 없음</div>
          <div class="button-grid auth-buttons">
            <button data-action="register">1. 회원가입</button>
            <button data-action="login">2. 로그인</button>
            <button data-action="list_auth">3. 목록 조회 (인증)</button>
            <button data-action="create_auth">4. 생성 (인증)</button>
            <button data-action="get_auth">5. 단일 조회 (인증)</button>
            <button data-action="profile">6. 내 프로필</button>
          </div>
        </section>

        <!-- Step 4: 비동기 -->
        <section class="card">
          <h2>비동기 + 백그라운드 (Step 4)</h2>
          <p class="hint">async/await 비동기 처리와 BackgroundTasks 비교</p>
          <div class="button-grid async-buttons">
            <button data-action="async_list">1. 비동기 조회</button>
            <button data-action="async_create">2. 비동기 생성</button>
            <button data-action="sequential">3. 순차 처리 (느림)</button>
            <button data-action="concurrent">4. 동시 처리 (빠름!)</button>
            <button data-action="bg_log">5. 백그라운드 로그</button>
            <button data-action="bg_email">6. 백그라운드 이메일</button>
          </div>
        </section>

        <!-- Step 5: 에러 핸들링 -->
        <section class="card">
          <h2>에러 핸들링 테스트 (Step 5)</h2>
          <p class="hint">전역 예외 핸들러 + CORS 설정 확인</p>
          <div class="button-grid error-buttons">
            <button data-action="test_duplicate">1. 중복 에러 발생</button>
            <button data-action="test_not_found">2. 404 에러</button>
            <button data-action="test_validation">3. 검증 에러</button>
          </div>
          <p class="hint">CORS는 다른 도메인에서 접근 시 확인 가능</p>
        </section>

        <!-- Step 6: 파일 업로드 + 테스팅 -->
        <section class="card">
          <h2>파일 업로드 + 테스팅 (Step 6)</h2>
          <p class="hint">파일 업로드 및 pytest 테스트 실행</p>
          <div class="input-grid" style="margin-bottom: 15px;">
            <label>파일 선택
              <input type="file" id="upload-file" accept=".jpg,.jpeg,.png,.gif,.pdf,.txt,.csv" />
            </label>
          </div>
          <div class="button-grid upload-buttons">
            <button data-action="upload_file">1. 파일 업로드</button>
            <button data-action="list_uploads">2. 업로드 목록</button>
            <button data-action="clear_uploads">3. 파일 초기화</button>
            <button data-action="run_tests">4. 테스트 실행</button>
          </div>
        </section>
      </div>

      <!-- 오른쪽 패널: 결과 및 코드 흐름 -->
      <div class="right-panel">
        <!-- API 응답 표시 영역 -->
        <section class="card">
          <h2>📤 API 응답</h2>
          <pre id="output">버튼을 클릭하면 결과가 여기에 표시됩니다.</pre>
        </section>

        <!-- 코드 흐름 표시 영역 -->
        <section class="card">
          <h2>🔍 코드 실행 흐름</h2>
          <div id="code-flow">
            <p class="hint">버튼을 클릭하면 해당 기능의 코드 흐름이 여기에 표시됩니다.</p>
          </div>
        </section>
      </div>
    </div>

    <script src="/static/app.js"></script>
  </body>
</html>
